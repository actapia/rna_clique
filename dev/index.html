
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      
        <link rel="next" href="usage/">
      
      
      <link rel="icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.16">
    
    
      
        <title>RNA-clique user guide</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.7e37652d.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL(".",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#rna-clique" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="." title="RNA-clique user guide" class="md-header__button md-logo" aria-label="RNA-clique user guide" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            RNA-clique user guide
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Home
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/actapia/rna_clique" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="." title="RNA-clique user guide" class="md-nav__button md-logo" aria-label="RNA-clique user guide" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    RNA-clique user guide
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/actapia/rna_clique" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="." class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#installation" class="md-nav__link">
    <span class="md-ellipsis">
      Installation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Installation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#requirements" class="md-nav__link">
    <span class="md-ellipsis">
      Requirements
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Requirements">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#main-software" class="md-nav__link">
    <span class="md-ellipsis">
      Main software
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#phylogenetics-and-visualization" class="md-nav__link">
    <span class="md-ellipsis">
      Phylogenetics and Visualization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sequence-simulation-needed-for-testing-installation" class="md-nav__link">
    <span class="md-ellipsis">
      Sequence simulation (needed for testing installation)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#installation-guides" class="md-nav__link">
    <span class="md-ellipsis">
      Installation guides
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#testing-the-installation" class="md-nav__link">
    <span class="md-ellipsis">
      Testing the installation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#command-line-usage" class="md-nav__link">
    <span class="md-ellipsis">
      Command-line usage
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Command-line usage">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#phase-1-building-the-gene-matches-graph" class="md-nav__link">
    <span class="md-ellipsis">
      Phase 1: Building the gene matches graph
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#phase-2-calculating-distances" class="md-nav__link">
    <span class="md-ellipsis">
      Phase 2: Calculating distances
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#downstream-analyses" class="md-nav__link">
    <span class="md-ellipsis">
      Downstream analyses
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#using-rna-clique-in-python-code" class="md-nav__link">
    <span class="md-ellipsis">
      Using RNA-clique in Python code
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#license" class="md-nav__link">
    <span class="md-ellipsis">
      License
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#additional-documentation" class="md-nav__link">
    <span class="md-ellipsis">
      Additional documentation
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="usage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Command-line usage
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Installation guides
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Installation guides
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="installation_guides/ubuntu/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Ubuntu
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="installation_guides/macos/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    macOS
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Tutorials
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Tutorials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="tutorials/reads2tree/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    From RNA-seq reads to a phylogenetic tree with RNA-clique
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#installation" class="md-nav__link">
    <span class="md-ellipsis">
      Installation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Installation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#requirements" class="md-nav__link">
    <span class="md-ellipsis">
      Requirements
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Requirements">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#main-software" class="md-nav__link">
    <span class="md-ellipsis">
      Main software
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#phylogenetics-and-visualization" class="md-nav__link">
    <span class="md-ellipsis">
      Phylogenetics and Visualization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sequence-simulation-needed-for-testing-installation" class="md-nav__link">
    <span class="md-ellipsis">
      Sequence simulation (needed for testing installation)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#installation-guides" class="md-nav__link">
    <span class="md-ellipsis">
      Installation guides
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#testing-the-installation" class="md-nav__link">
    <span class="md-ellipsis">
      Testing the installation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#command-line-usage" class="md-nav__link">
    <span class="md-ellipsis">
      Command-line usage
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Command-line usage">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#phase-1-building-the-gene-matches-graph" class="md-nav__link">
    <span class="md-ellipsis">
      Phase 1: Building the gene matches graph
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#phase-2-calculating-distances" class="md-nav__link">
    <span class="md-ellipsis">
      Phase 2: Calculating distances
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#downstream-analyses" class="md-nav__link">
    <span class="md-ellipsis">
      Downstream analyses
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#using-rna-clique-in-python-code" class="md-nav__link">
    <span class="md-ellipsis">
      Using RNA-clique in Python code
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#license" class="md-nav__link">
    <span class="md-ellipsis">
      License
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#additional-documentation" class="md-nav__link">
    <span class="md-ellipsis">
      Additional documentation
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="rna-clique">RNA-clique</h1>
<p><a href="https://doi.org/10.5281/zenodo.14890599"><img alt="DOI" src="https://zenodo.org/badge/DOI/10.5281/zenodo.14890599.svg" /></a></p>
<p>This is the repository for RNA-clique, a tool for computing pairwise genetic
distances from RNA-seq data. The software accepts as input assembled
transcriptomes from two or more samples and produces as its output a matrix
containing pairwise distances ranging from 0 to 1.</p>
<h2 id="installation">Installation</h2>
<p>This software is written in Python, Perl, and Bash. The software additionally
requires NCBI BLAST+ and several Python and Perl libraries. The section below
lists the software requirements, and <a href="#installation-guides">guides</a> are provided
for installation of specific systems.</p>
<h3 id="requirements">Requirements</h3>
<p>The requirements below represent one tested configuration. This software may
work with different versions of the dependencies listed, but such configurations
are considered untested.</p>
<h4 id="main-software">Main software</h4>
<ul>
<li>Python 3.12</li>
<li>Perl 5.40.1</li>
<li>Bash 5.2.37</li>
<li>ncbi-blast 2.16.0+</li>
<li>Python libraries</li>
<li>tqdm 4.66.5</li>
<li>pandas 2.2.2</li>
<li>pytables 3.10.1</li>
<li>joblib 1.4.2</li>
<li>networkx 3.3</li>
<li><a href="https://github.com/actapia/simple_blast">simple-blast</a> 0.7.0</li>
<li>Perl libraries</li>
<li>Bio::SeqIO 1.7.8</li>
</ul>
<h4 id="phylogenetics-and-visualization">Phylogenetics and Visualization</h4>
<ul>
<li>Python libraries</li>
<li>BioPython 1.84</li>
<li>matplotlib 3.9.2</li>
<li>seaborn 0.13.2</li>
<li>scikit-bio 0.6.2</li>
</ul>
<h4 id="sequence-simulation-needed-for-testing-installation">Sequence simulation (needed for testing installation)</h4>
<ul>
<li>Python libraries</li>
<li>more-itertools 10.4.0</li>
<li>PyYAML 6.0.2</li>
<li>SciPy 1.14.1</li>
</ul>
<h3 id="installation-guides">Installation guides</h3>
<ul>
<li><a href="https://actapia.github.io/rna_clique/installation_guides/ubuntu">Ubuntu</a></li>
<li><a href="https://actapia.github.io/rna_clique/installation_guides/macos">macOS</a></li>
</ul>
<h3 id="testing-the-installation">Testing the installation</h3>
<p>After you have downloaded RNA-clique and installed its dependencies, you can
test your installation using a script included in this repository.</p>
<p>First, make sure your rna-clique conda environment is active.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>conda<span class="w"> </span>activate<span class="w"> </span>rna-clique
</span></code></pre></div>
<p>Then, if you are in the root the repository, you can run the following command
to begin the test script.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>bash<span class="w"> </span>tests/verify_install/test_install.sh<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Success!&quot;</span>
</span></code></pre></div>
<p>The script generates a small test dataset and runs RNA-clique on the generated
data. On a modern desktop with one thread, the test should take around one
minute to complete. On machines with multiple threads, the test script should
take advantage of parallelism to complete the test more quickly.</p>
<p>If you ran the script with the above command and see "Success!," then the
installation was succesful. Otherwise, you will need to investigate the output
of the test script to see what failed and why.</p>
<p>If the test script fails despite having a correct installation, you should
submit a bug report on GitHub at https://github.com/actapia/rna_clique/issues .</p>
<h2 id="command-line-usage">Command-line usage</h2>
<p>Running RNA-clique broadly involves two phases. In the first phase, the
transcriptomes are aligned, and the gene matches graph is built. In the second
phase, the gene matches graph is used to filter the BLAST alignments, and the
pairwise distances are calculated using the filtered alignment statistics.</p>
<p>Although there are only two phases, each phase may be performed by multiple
scripts. To simplify usage of this program, we have provided a script,
<code>typical_filtering_step.sh</code> that may be used to easily perform the first phase
with typical parameter settings.</p>
<h3 id="phase-1-building-the-gene-matches-graph">Phase 1: Building the gene matches graph</h3>
<p>The simplest usage of <code>typical_filtering_step.sh</code> provides only an output
directory, a value for the number of top genes to select (<code>n</code>), and the
directories containing the transcriptomes to be analyzed.</p>
<p>The script assumes that the transcriptomes are stored in FASTA files with the
<em>identical names</em> in different directories. By default, RNA-clique assumes the
files are all named <code>transcripts.fasta</code>, since this is the default output name
for the SPAdes assembler, but this behavior may be overridden by a command-line
argument. </p>
<p>For example, the first transcriptome might be located at
<code>sample1/transcripts.fasta</code>, and the second might be located
at<code>sample2/assembly.fasta</code>.</p>
<p><strong>WARNING: The transcriptomes are identified internally by the names of the
directories in which they are contained, so every transcriptome must be located
in a directory with a unique name!</strong></p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>bash<span class="w"> </span>typical_filtering_step.sh<span class="w"> </span>-n<span class="w"> </span>TOP_GENES<span class="w"> </span>-o<span class="w"> </span>OUTPUT_DIR<span class="w"> </span>DIR1<span class="w"> </span>DIR2<span class="w"> </span>...
</span></code></pre></div>
<p>In the command above, <code>TOP_GENES</code> must be replaced by the number of top genes to
select. <code>OUTPUT_DIR</code> should be replaced by the path to the directory in which to
store output files. <code>DIR1 DIR2 ...</code> are the paths to the directories containing
the transcriptomes to be analyzed. The transcriptomes are assumed be located at
files named <code>transcripts.fasta</code> within those directories.</p>
<p>When the script finishes, it creates <code>graph.pkl</code> in the specified output
directory. <code>graph.pkl</code> is a Python pickle file representing the constructed
gene matches graph.</p>
<p>The script also stores HDF5 files (formerly Python pickles) for the pairwise
BLAST results. The BLAST results can be found in the <code>od2</code> subdirectory of the
output directory.</p>
<h3 id="phase-2-calculating-distances">Phase 2: Calculating distances</h3>
<p>The <code>filtered_distance.py</code> Python script may be used to compute distances or
similarities from a gene matches graph. Basic usage of the command requires
only that we provide the pickles for the gene matches graph and the HDF5 files
for the pairwise BLAST results.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>python<span class="w"> </span>filtered_distance.py<span class="w"> </span>-g<span class="w"> </span>GRAPH<span class="w"> </span>-c<span class="w"> </span>COMPARISONS_DIR/*.h5
</span></code></pre></div>
<p>In the above command, GRAPH should be the path to the <code>graph.pkl</code> created in the
first phase, and COMPARISONS_DIR should be the directory that contains the BLAST
result HDF5 files. (This will be the <code>od2</code> subdirectory of the output directory
from Phase 1 if you used the <code>typical_filtering_step.sh</code> script.)</p>
<p>The script outputs a genetic similarity matrix to standard output by default. To
get a distance matrix, you can provide the <code>-o dis</code> option to
<code>filtered_distance.py</code>.</p>
<p>Both the rows and the columns of the matrix are sorted alphabetically by sample
ID. To print the order of the samples to standard error, you can provide the
<code>-l</code> flag to <code>filtered_distance.py</code>.</p>
<h3 id="downstream-analyses">Downstream analyses</h3>
<p>The <code>filtered_distance.py</code> script prints the calculated matrix to the standard
output, so you can use redirection or pipes to save the results to a file. You
could then use the matrix in any downstream application capable of loading
arbitrary matrices from files.</p>
<p>For example, if you output the matrix to a file named <code>distances</code>, you could
load the matrix in R using the following code:</p>
<div class="language-R highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="n">dis</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.matrix</span><span class="p">(</span><span class="nf">read.table</span><span class="p">(</span><span class="s">&quot;distances&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">sep</span><span class="o">=</span><span class="s">&quot; &quot;</span><span class="p">))</span>
</span></code></pre></div>
<p>If you are using Python, you may wish to skip Phase 2 and <a href="#using-rna-clique-in-python-code">use RNA-clique
directly in your code instead</a>.</p>
<h2 id="using-rna-clique-in-python-code">Using RNA-clique in Python code</h2>
<p>Since parts of Phase 1 are implemented in Bash and Perl, there is currently no
official way to perform Phase 1 from custom Python code, but since Phase 2 is
written exclusively in Python, we describe an official way of performing that
phase in custom code here.</p>
<p>The <code>filtered_distance.py</code> is a straightforward command-line interface to
RNA-clique's <code>SampleSimilarity</code> class. If you are planning to use the distance
matrix computed by RNA-clique in a downstream analysis implemented in Python, it
may be easier to simply use <code>SampleSimilarity</code> directly instead of running
<code>filtered_distance.py</code> and loading the calculated matrix back into Python.</p>
<p>The <code>SampleSimilarity</code> class is ordinarily constructed with the following
arguments:</p>
<ul>
<li>A NetworkX graph representing the gene matches graph.</li>
<li>An Iterable of pairs to be interpreted as a mapping between unordered pairs
   of sample names and dataframes containing the parsed BLAST results for the
   pairs' comparisons. (For example, if you had a <code>dict</code> <code>d</code> mapping
   <code>frozenset</code>s containing pairs of sample names to the BLAST results for those
   pairs of samples, then <code>d.items()</code> would be an appropriate actual parameter.)</li>
<li>An optional integer indicating how many samples are present. (If no value is
   provided for this parameter, it will be calculated automatically.)</li>
</ul>
<p>This constructor may be difficult to use if you are simply given the file paths
to the pickles for the graph and the BLAST comparisons, so <code>SampleSimilarity</code>
also includes a <code>from_filenames</code> classmethod that constructs a
<code>SampleSimilarity</code> object using the following parameters:</p>
<ul>
<li>A path to the pickle containing the gene matches graph.</li>
<li>A list of paths to the BLAST comparisons.</li>
<li>An optional <code>bool</code> indicating whether to keep the comparison dataframes after
  the distance computation has finished.</li>
</ul>
<p><code>SampleSimilarity</code> computes the similarities lazily; it won't do any of the
time-consuming work until it's asked for results. <code>SampleSimilarity</code> offers
several ways to view the results.</p>
<p><code>get_similarities</code> and <code>get_dissimilarities</code> return a <code>MultisetKeyDict</code> that
maps unordered pairs of sample names to their similarities or dissimilarities
(distances), respectively. The <code>MultisetKeyDict</code> for the  similarities may also
be accessed via the <code>similarities</code> property, but note that there is no
corresponding <code>dissimilarities</code> or <code>distances</code> property.</p>
<p><code>get_similarity_matrix</code> and <code>get_dissimilarity_matrix</code> offer the same
information as matrices&mdash;i.e., NumPy arrays. The returned matrices are
symmetric, but the distances are only computed in one direction by
RNA-clique. The rows and columns of the matrix correspond to the samples sorted
alphabetically by name. To get this ordered list of samples, you can use the
<code>samples</code> property of <code>SampleSimilarity</code>.</p>
<h2 id="license">License</h2>
<p>All code except tests/test_install/macos.sh is licensed under the MIT license,
which may be found at LICENSE.MIT at the root of this repository.</p>
<p><a href="https://github.com/actapia/rna_clique/blob/main/tests/test_install/macos.sh">tests/test_install/macos.sh</a>
is licensed under the Creative Commons Attribution-ShareAlike 4.0 License, which
may be found at LICENSE.CC-BY-SA-4.0 at the root of this repository.</p>
<p>A machine-readable copyright file in Debian format may also be found at
<a href="https://github.com/actapia/rna_clique/blob/main/copyright">copyright</a>.</p>
<h2 id="additional-documentation">Additional documentation</h2>
<ul>
<li><a href="https://actapia.github.io/rna_clique/usage">Command-line usage guide</a></li>
<li><a href="https://actapia.github.io/rna_clique/tutorials/reads2tree">Tutorial: From RNA-seq reads to a phylogenetic tree with RNA-clique</a></li>
</ul>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": ".", "features": ["content.code.copy"], "search": "assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"alias": true, "provider": "mike"}}</script>
    
    
      <script src="assets/javascripts/bundle.50899def.min.js"></script>
      
        <script src="javascripts/mathjax.js"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>